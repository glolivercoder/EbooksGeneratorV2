DESPlano de ImplementaÃ§Ã£o: Aba DESIGN (Conceito Correto)
Data: 2025-12-03
Status: ğŸ”„ Replanning - Conceito Corrigido

âŒ Erro Conceitual Anterior
O que estava sendo feito (ERRADO):
React Flow criando organogramas/diagramas
Nodes com texto simples
Sem design visual real
Sem HTML/CSS estilizado
Sem tipografia moderna
Sem cores/imagens adequadas
Resultado: Templates "estruturais" sem apelo visual

âœ… Conceito Correto: IA como Designer GrÃ¡fico
O que deve ser feito:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EDITOR (TipTap)                            â”‚
â”‚  "Design Thinking: O Guia Definitivo"      â”‚
â”‚  - ConteÃºdo sobre inovaÃ§Ã£o                 â”‚
â”‚  - Tom: Profissional/Moderno                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  IA DESIGNER AGENT                          â”‚
â”‚  - Analisa contexto do texto                â”‚
â”‚  - Identifica tema (tech, negÃ³cios, etc.)   â”‚
â”‚  - Define paleta de cores moderna           â”‚
â”‚  - Escolhe tipografia adequada              â”‚
â”‚  - Seleciona imagens/assets                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DESIGN TAB (Fabric.js)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ¨ Capa com gradiente moderno         â”‚  â”‚
â”‚  â”‚ Typography: Inter, 48pt, Bold         â”‚  â”‚
â”‚  â”‚ Cor: #667eea â†’ #764ba2               â”‚  â”‚
â”‚  â”‚ Imagem de fundo: Abstract tech        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“„ PÃ¡ginas internas                   â”‚  â”‚
â”‚  â”‚ Headers coloridos, margens elegantes  â”‚  â”‚
â”‚  â”‚ Fontes hierÃ¡rquicas (H1, H2, body)    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  APLICAR AO EDITOR                          â”‚
â”‚  - HTML + CSS inline gerado                 â”‚
â”‚  - Imagens embedded (base64 ou URLs)        â”‚
â”‚  - Estilos importados para TipTap           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ğŸ¨ Aba DESIGN: Arquitetura
Stack TecnolÃ³gica
// Design Tab
{
  "canvas": "Fabric.js",
  "ai": "OpenAI GPT-4o (multimodal)",
  "imageGen": "DALL-E 3",
  "typography": "Google Fonts API",
  "colorPalettes": "Coolors API / IA generated",
  "export": "@react-pdf/renderer ou HTML direto"
}
Componentes Principais
frontend/src/components/Design/
â”œâ”€â”€ DesignCanvas.tsx          // Canvas Fabric.js principal
â”œâ”€â”€ DesignToolbar.tsx         // Ferramentas (texto, imagem, formas)
â”œâ”€â”€ DesignSidebar.tsx         // Paletas de cores, fontes
â”œâ”€â”€ AIDesignPanel.tsx         // Controles IA
â”œâ”€â”€ LayersPanel.tsx           // Gerenciamento de camadas
â”œâ”€â”€ TemplateGallery.tsx       // Templates prÃ©-definidos
â””â”€â”€ utils/
    â”œâ”€â”€ fabricHelpers.ts      // Utilities Fabric.js
    â”œâ”€â”€ designToHTML.ts       // Converter design â†’ HTML
    â””â”€â”€ styleExtractor.ts     // Extrair estilos do text
ğŸ¤– Design Agent: IA como Designer Profissional
Responsabilidades
# backend/agents/design_agent.py
class DesignAgent:
    """
    IA que atua como designer grÃ¡fico profissional
    Especialista em:
    - Tipografia moderna
    - Teoria das cores
    - Layout editorial
    - Design de capas
    """
    
    async def analyze_content(self, editor_html: str):
        """
        Analisa conteÃºdo do editor para determinar estilo
        
        Returns:
        {
            "topic": "tecnologia",
            "tone": "professional",
            "target_audience": "desenvolvedores",
            "suggested_style": "modern-tech",
            "color_palette": ["#667eea", "#764ba2", ...],
            "typography": {
                "heading": "Inter",
                "body": "Lato",
                "accent": "Playfair Display"
            }
        }
        """
        
    async def generate_cover_design(self, analysis: dict):
        """
        Gera design de capa profissional
        
        Returns:
        {
            "html": "<div class='cover'>...</div>",
            "css": "...",
            "background_image": "data:image/png;base64,...",
            "fabric_objects": [...]  // Para ediÃ§Ã£o
        }
        """
        
    async def generate_page_template(self, page_type: str):
        """
        Gera template de pÃ¡gina (introduÃ§Ã£o, capÃ­tulo, etc.)
        
        Returns:
        {
            "html": "...",
            "css": "...",
            "layout": "two-column" | "single" | "magazine"
        }
        """
Prompt Engineering para IA Designer
DESIGNER_SYSTEM_PROMPT = """
VocÃª Ã© um designer grÃ¡fico sÃªnior especializado em editoraÃ§Ã£o de livros e revistas.
EXPERTISE:
- Tipografia: hierarquia, legibilidade, kerning
- Cores: teoria das cores, harmonia, acessibilidade
- Layout: grid systems, whitespace, flow
- TendÃªncias: design moderno 2024/2025
ESTILOS QUE VOCÃŠ DOMINA:
- Minimalismo escandinavo
- Design editorial clÃ¡ssico
- Tech/futurista
- Corporativo elegante
- ArtÃ­stico/criativo
FERRAMENTAS:
- HTML5 + CSS3 moderno (Flexbox, Grid)
- Google Fonts
- Gradientes CSS
- SVG para elementos grÃ¡ficos
TAREFA:
Analise o conteÃºdo fornecido e crie um design visual COMPLETO com:
1. Paleta de cores (mÃ­nimo 5 cores)
2. Tipografia (heading, body, accent)
3. Layout de capa (HTML + CSS)
4. Templates de pÃ¡ginas internas
5. Elementos grÃ¡ficos (bordas, separadores, etc.)
Retorne JSON estruturado.
"""
ğŸ“ Interface da Aba DESIGN
Layout Visual
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DESIGN TAB                                  [â˜° Menu] [Ã—]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  SIDEBAR    â”‚  â”‚     CANVAS (Fabric.js)           â”‚    â”‚
â”‚  â”‚             â”‚  â”‚                                  â”‚    â”‚
â”‚  â”‚ ğŸ¨ Cores    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚ â€¢ #667eea   â”‚  â”‚  â”‚  CAPA                    â”‚   â”‚    â”‚
â”‚  â”‚ â€¢ #764ba2   â”‚  â”‚  â”‚                          â”‚   â”‚    â”‚
â”‚  â”‚ â€¢ #f093fb   â”‚  â”‚  â”‚  Design Thinking         â”‚   â”‚    â”‚
â”‚  â”‚             â”‚  â”‚  â”‚  O Guia Definitivo       â”‚   â”‚    â”‚
â”‚  â”‚ ğŸ”¤ Fontes   â”‚  â”‚  â”‚                          â”‚   â”‚    â”‚
â”‚  â”‚ â€¢ Inter     â”‚  â”‚  â”‚  [Imagem de fundo]       â”‚   â”‚    â”‚
â”‚  â”‚ â€¢ Lato      â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚             â”‚  â”‚                                  â”‚    â”‚
â”‚  â”‚ ğŸ–¼ï¸ Imagens  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚ [Galeria]   â”‚  â”‚  â”‚  PÃ¡gina Interna          â”‚   â”‚    â”‚
â”‚  â”‚             â”‚  â”‚  â”‚  Header colorido         â”‚   â”‚    â”‚
â”‚  â”‚ ğŸ¤– IA       â”‚  â”‚  â”‚  Texto formatado         â”‚   â”‚    â”‚
â”‚  â”‚ [Analisar]  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚ [Gerar]     â”‚  â”‚                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  TOOLBAR                                           â”‚   â”‚
â”‚  â”‚  [Texto] [Imagem] [Forma] [Linha] [Gradiente]     â”‚   â”‚
â”‚  â”‚  [Camadas] [Alinhar] [Zoom] [Exportar]            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â”‚  [ğŸ’¾ Salvar Design] [ğŸ“„ Aplicar ao Editor] [ğŸ”„ Reset]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
## ğŸ“„ ConfiguraÃ§Ãµes de Layout

A aba Design permite configuraÃ§Ã£o completa do layout das pÃ¡ginas do ebook:

### Tamanho da PÃ¡gina
```typescript
interface PageSize {
  preset: 'A4' | 'Letter' | 'A5' | 'Custom'
  width: number  // mm
  height: number // mm
  orientation: 'portrait' | 'landscape'
}

const PAGE_PRESETS = {
  A4: { width: 210, height: 297 },
  Letter: { width: 215.9, height: 279.4 },
  A5: { width: 148, height: 210 },
  '6x9': { width: 152.4, height: 228.6 }, // PadrÃ£o Amazon KDP
}
```

**Interface:**
```tsx
<div className="page-size-selector">
  <h3>ğŸ“ Tamanho da PÃ¡gina</h3>
  <div className="presets">
    <button>A4 (210x297mm)</button>
    <button>Letter (8.5x11")</button>
    <button>A5 (148x210mm)</button>
    <button>6x9" (KDP)</button>
    <button>Custom</button>
  </div>
  
  <div className="orientation">
    <label>
      <input type="radio" name="orient" value="portrait" />
      ğŸ“± Retrato
    </label>
    <label>
      <input type="radio" name="orient" value="landscape" />
      ğŸ–¥ï¸ Paisagem
    </label>
  </div>
</div>
```

### Margens
```typescript
interface Margins {
  top: number
  right: number
  bottom: number
  left: number
  unit: 'mm' | 'in' | 'px'
  gutter?: number // Margem extra para encadernaÃ§Ã£o
  mirror?: boolean // Margens espelhadas (Ã­mpares/pares)
}

const MARGIN_PRESETS = {
  narrow: { top: 12.7, right: 12.7, bottom: 12.7, left: 12.7 },
  normal: { top: 25.4, right: 25.4, bottom: 25.4, left: 25.4 },
  wide: { top: 38.1, right: 38.1, bottom: 38.1, left: 38.1 },
  mirrored: { top: 25.4, right: 19.1, bottom: 25.4, left: 31.8, mirror: true }
}
```

**Interface:**
```tsx
<div className="margins-config">
  <h3>ğŸ“ Margens</h3>
  
  <div className="presets">
    <button>Estreitas</button>
    <button>Normais</button>
    <button>Largas</button>
    <button>Espelhadas</button>
  </div>
  
  <div className="custom-margins">
    <input type="number" placeholder="Superior" />
    <input type="number" placeholder="Direita" />
    <input type="number" placeholder="Inferior" />
    <input type="number" placeholder="Esquerda" />
  </div>
  
  <label>
    <input type="checkbox" />
    Adicionar margem de encadernaÃ§Ã£o (gutter)
  </label>
</div>
```

## ğŸ”¤ ConfiguraÃ§Ãµes de Tipografia

Sistema completo de tipografia hierÃ¡rquica:

### Fontes Principais
```typescript
interface TypographyConfig {
  primary: FontConfig      // TÃ­tulos principais
  secondary: FontConfig    // SubtÃ­tulos
  body: FontConfig        // Corpo de texto
  accent: FontConfig      // Destaques
  monospace: FontConfig   // CÃ³digo
}

interface FontConfig {
  family: string
  weights: number[]
  fallback: string[]
  googleFont: boolean
}
```

**Banco de Fontes Curadas:**
```typescript
const FONT_LIBRARY = {
  serif: [
    { name: 'Playfair Display', use: 'Elegante, editorial' },
    { name: 'Merriweather', use: 'LegÃ­vel, clÃ¡ssico' },
    { name: 'Lora', use: 'Moderno, versÃ¡til' },
    { name: 'Crimson Text', use: 'LiterÃ¡rio' }
  ],
  sansSerif: [
    { name: 'Inter', use: 'Tech, moderno' },
    { name: 'Lato', use: 'Corporativo' },
    { name: 'Open Sans', use: 'Universal' },
    { name: 'Montserrat', use: 'Bold, impactante' }
  ],
  display: [
    { name: 'Bebas Neue', use: 'TÃ­tulos impactantes' },
    { name: 'Oswald', use: 'Condensado' },
    { name: 'Righteous', use: 'Criativo' }
  ],
  monospace: [
    { name: 'Fira Code', use: 'CÃ³digo com ligaduras' },
    { name: 'JetBrains Mono', use: 'CÃ³digo moderno' }
  ]
}
```

### Tamanhos e Hierarquia
```typescript
interface TypographyScale {
  h1: { size: number, lineHeight: number, weight: number }
  h2: { size: number, lineHeight: number, weight: number }
  h3: { size: number, lineHeight: number, weight: number }
  h4: { size: number, lineHeight: number, weight: number }
  body: { size: number, lineHeight: number, weight: number }
  small: { size: number, lineHeight: number, weight: number }
  caption: { size: number, lineHeight: number, weight: number }
}

const TYPOGRAPHY_SCALES = {
  traditional: {
    h1: { size: 36, lineHeight: 1.2, weight: 700 },
    h2: { size: 28, lineHeight: 1.3, weight: 600 },
    h3: { size: 22, lineHeight: 1.4, weight: 600 },
    body: { size: 12, lineHeight: 1.6, weight: 400 }
  },
  modern: {
    h1: { size: 48, lineHeight: 1.1, weight: 800 },
    h2: { size: 32, lineHeight: 1.2, weight: 700 },
    h3: { size: 24, lineHeight: 1.3, weight: 600 },
    body: { size: 14, lineHeight: 1.7, weight: 400 }
  },
  compact: {
    h1: { size: 32, lineHeight: 1.2, weight: 700 },
    h2: { size: 24, lineHeight: 1.3, weight: 600 },
    body: { size: 11, lineHeight: 1.5, weight: 400 }
  }
}
```

**Interface:**
```tsx
<div className="typography-panel">
  <h3>ğŸ”¤ Tipografia</h3>
  
  {/* Font Selector */}
  <div className="font-selector">
    <label>TÃ­tulo Principal</label>
    <select>
      <optgroup label="Serif">
        <option>Playfair Display</option>
        <option>Merriweather</option>
      </optgroup>
      <optgroup label="Sans-Serif">
        <option>Inter</option>
        <option>Lato</option>
      </optgroup>
    </select>
    
    <div className="font-preview">
      <h1 style={{ fontFamily: selectedFont }}>Design Thinking</h1>
    </div>
  </div>
  
  {/* Scale Preset */}
  <div className="scale-selector">
    <button>Tradicional</button>
    <button>Moderno</button>
    <button>Compacto</button>
  </div>
  
  {/* Fine Tuning */}
  <div className="typography-controls">
    <div>
      <label>H1 - TÃ­tulo Principal</label>
      <input type="range" min="24" max="72" /> <span>48pt</span>
      <input type="range" min="100" max="900" step="100" /> <span>700</span>
    </div>
    <div>
      <label>Corpo de Texto</label>
      <input type="range" min="10" max="18" /> <span>12pt</span>
      <input type="range" min="1.2" max="2.0" step="0.1" /> <span>1.6</span>
    </div>
  </div>
  
  {/* Advanced */}
  <details>
    <summary>âš™ï¸ ConfiguraÃ§Ãµes AvanÃ§adas</summary>
    <label>Letter Spacing: <input type="range" min="-50" max="50" /></label>
    <label>Word Spacing: <input type="range" min="0" max="20" /></label>
    <label>Kerning: <input type="checkbox" checked /> Ativado</label>
  </details>
</div>
```

## ğŸ¨ Cores e Tema

Sistema inteligente de paleta de cores:

### Esquema de Cores
```typescript
interface ColorScheme {
  name: string
  primary: string
  secondary: string
  accent: string
  background: string
  surface: string
  text: {
    primary: string
    secondary: string
    disabled: string
  }
  semantic: {
    success: string
    warning: string
    error: string
    info: string
  }
}

const COLOR_SCHEMES = {
  modernPurple: {
    name: 'Modern Purple',
    primary: '#667eea',
    secondary: '#764ba2',
    accent: '#f093fb',
    background: '#ffffff',
    surface: '#f5f7fa',
    text: {
      primary: '#2d3748',
      secondary: '#718096',
      disabled: '#cbd5e0'
    }
  },
  techBlue: {
    name: 'Tech Blue',
    primary: '#0099ff',
    secondary: '#00d4ff',
    accent: '#e94560',
    background: '#1a1a2e',
    surface: '#16213e',
    text: {
      primary: '#ffffff',
      secondary: '#a0aec0',
      disabled: '#4a5568'
    }
  },
  earthyWarm: {
    name: 'Earthy Warm',
    primary: '#8b7355',
    secondary: '#c19a6b',
    accent: '#d4a574',
    background: '#f4e8c1',
    surface: '#ffffff',
    text: {
      primary: '#2c2416',
      secondary: '#5a4a3a'
    }
  }
}
```

### GeraÃ§Ã£o Inteligente de Cores
```python
# backend/agents/color_agent.py
class ColorAgent:
    """Gera paletas baseadas no conteÃºdo"""
    
    async def generate_palette(self, content_analysis: dict):
        """
        Analisa tema e gera paleta harmÃ´nica
        
        Input: {"topic": "tecnologia", "tone": "professional"}
        Output: {
            "primary": "#667eea",
            "harmony": "complementary",
            "wcag_compliant": true,
            "mood": "confiante, inovador"
        }
        """
        
    def validate_contrast(self, fg: str, bg: str) -> float:
        """Garante WCAG AAA (contraste mÃ­nimo 7:1)"""
```

**Interface:**
```tsx
<div className="color-panel">
  <h3>ğŸ¨ Cores e Tema</h3>
  
  {/* AI Generation */}
  <button className="ai-generate">
    ğŸ¤– Gerar Paleta pela IA
  </button>
  
  {/* Preset Schemes */}
  <div className="color-schemes">
    {COLOR_SCHEMES.map(scheme => (
      <div className="scheme-card">
        <div className="palette-preview">
          <span style={{ background: scheme.primary }} />
          <span style={{ background: scheme.secondary }} />
          <span style={{ background: scheme.accent }} />
        </div>
        <span>{scheme.name}</span>
      </div>
    ))}
  </div>
  
  {/* Custom Editor */}
  <div className="color-editor">
    <div className="color-input">
      <label>Cor Principal</label>
      <input type="color" value="#667eea" />
      <input type="text" value="#667eea" />
    </div>
    
    <div className="harmony-generator">
      <button>Complementar</button>
      <button>AnÃ¡logo</button>
      <button>TriÃ¡dico</button>
      <button>TetrÃ¡dico</button>
    </div>
  </div>
  
  {/* Gradient Builder */}
  <div className="gradient-builder">
    <h4>Gradientes</h4>
    <div className="gradient-preview" style={{
      background: 'linear-gradient(135deg, #667eea, #764ba2)'
    }} />
    <button>Editar Gradiente</button>
  </div>
  
  {/* Accessibility Check */}
  <div className="a11y-check">
    <span>Contraste WCAG: </span>
    <span className="badge-success">AAA (8.2:1)</span>
  </div>
</div>
```

## ğŸ–¼ï¸ Elementos Visuais

Componentes de layout e ornamentaÃ§Ã£o:

### CabeÃ§alhos e RodapÃ©s
```typescript
interface HeaderFooterConfig {
  enabled: boolean
  type: 'simple' | 'decorative' | 'minimal'
  content: {
    left?: string   // e.g., "${chapterTitle}"
    center?: string // e.g., "${pageNumber}"
    right?: string  // e.g., "${authorName}"
  }
  style: {
    height: number
    fontSize: number
    separator?: 'line' | 'dots' | 'ornament' | 'none'
  }
  firstPage?: 'hide' | 'different'
}
```

**Templates de Header/Footer:**
```tsx
const HEADER_TEMPLATES = [
  {
    name: 'ClÃ¡ssico',
    preview: 'â”€â”€â”€â”€â”€â”€â”€â”€â”€ 12 â”€â”€â”€â”€â”€â”€â”€â”€â”€',
    config: {
      center: '${pageNumber}',
      separator: 'line'
    }
  },
  {
    name: 'Editorial',
    preview: 'CapÃ­tulo 1 Â· Â· Â· 12',
    config: {
      left: '${chapterTitle}',
      right: '${pageNumber}',
      separator: 'dots'
    }
  },
  {
    name: 'Moderno',
    preview: 'Design Thinking        |        12',
    config: {
      left: '${bookTitle}',
      right: '${pageNumber}',
      separator: 'none'
    }
  }
]
```

### NumeraÃ§Ã£o de PÃ¡ginas
```typescript
interface PageNumbering {
  enabled: boolean
  position: 'top-left' | 'top-center' | 'top-right' | 
            'bottom-left' | 'bottom-center' | 'bottom-right'
  format: 'numeric' | 'roman' | 'alphabetic'
  startAt: number
  prefix?: string
  suffix?: string
  style: {
    fontSize: number
    fontFamily: string
    color: string
    decoration?: 'circle' | 'square' | 'ornament' | 'none'
  }
}
```

### Ãndice AutomÃ¡tico
```typescript
interface TOCConfig {
  enabled: boolean
  title: string
  levels: number[] // [1, 2, 3] = H1, H2, H3
  style: 'dotted' | 'clean' | 'modern' | 'classic'
  pageBreakAfter: boolean
  includePageNumbers: boolean
}
```

**GeraÃ§Ã£o AutomÃ¡tica:**
```tsx
const generateTOC = (editorContent: string) => {
  const headings = extractHeadings(editorContent)
  
  return (
    <div className="table-of-contents">
      <h1>Ãndice</h1>
      {headings.map((h, idx) => (
        <div className={`toc-item level-${h.level}`}>
          <span className="title">{h.text}</span>
          <span className="dots"></span>
          <span className="page">{h.pageNumber}</span>
        </div>
      ))}
    </div>
  )
}
```

### Capa do Ebook
```typescript
interface CoverConfig {
  layout: 'centered' | 'split' | 'asymmetric' | 'fullbleed'
  background: {
    type: 'color' | 'gradient' | 'image' | 'pattern'
    value: string
  }
  elements: CoverElement[]
  overlay?: {
    color: string
    opacity: number
  }
}

interface CoverElement {
  type: 'title' | 'subtitle' | 'author' | 'image' | 'decoration'
  content: string
  position: { x: number, y: number }
  style: CSSProperties
}
```

**Templates de Capa:**
```tsx
const COVER_TEMPLATES = [
  {
    name: 'Gradiente Moderno',
    thumbnail: '/covers/modern-gradient.png',
    config: {
      background: 'linear-gradient(135deg, #667eea, #764ba2)',
      title: { size: 72, weight: 800, color: 'white', position: 'center' },
      decoration: 'geometric-pattern'
    }
  },
  {
    name: 'Imagem de Fundo',
    thumbnail: '/covers/image-bg.png',
    config: {
      background: 'image',
      overlay: { color: '#000', opacity: 0.5 },
      title: { size: 64, weight: 700, color: 'white', position: 'bottom' }
    }
  },
  {
    name: 'Minimalista',
    thumbnail: '/covers/minimal.png',
    config: {
      background: '#ffffff',
      title: { size: 48, weight: 300, color: '#333', position: 'top' },
      decoration: 'line-accent'
    }
  }
]
```

## ğŸ­ Templates e Temas PrÃ©-definidos

Sistema completo de templates prontos:

### Categorias de Templates
```typescript
interface TemplateCategory {
  id: string
  name: string
  description: string
  templates: Template[]
}

const TEMPLATE_CATEGORIES = [
  {
    id: 'tech',
    name: 'Tecnologia',
    description: 'Para livros sobre programaÃ§Ã£o, IA, startups',
    templates: [
      'Modern Tech', 'Cyberpunk', 'Developer Guide', 'SaaS Clean'
    ]
  },
  {
    id: 'business',
    name: 'NegÃ³cios',
    description: 'Corporativo, lideranÃ§a, empreendedorismo',
    templates: [
      'Corporate Blue', 'Executive', 'Startup', 'Finance Pro'
    ]
  },
  {
    id: 'creative',
    name: 'Criativo',
    description: 'Arte, design, fotografia',
    templates: [
      'Artist Portfolio', 'Magazine Style', 'Photo Book', 'Bohemian'
    ]
  },
  {
    id: 'academic',
    name: 'AcadÃªmico',
    description: 'Teses, papers, livros tÃ©cnicos',
    templates: [
      'Thesis Classic', 'Research Paper', 'Textbook', 'Journal'
    ]
  },
  {
    id: 'fiction',
    name: 'FicÃ§Ã£o',
    description: 'Romances, contos, poesia',
    templates: [
      'Novel Classic', 'Mystery Dark', 'Romance Light', 'Poetry Minimal'
    ]
  }
]
```

### Template Completo
```typescript
interface Template {
  id: string
  name: string
  category: string
  thumbnail: string
  preview: string // URL para preview interativo
  
  // Design System
  layout: PageLayoutConfig
  typography: TypographyConfig
  colors: ColorScheme
  
  // Components
  cover: CoverConfig
  header: HeaderFooterConfig
  footer: HeaderFooterConfig
  toc: TOCConfig
  
  // Assets
  decorations: DecorationAsset[]
  patterns: PatternAsset[]
}
```

**Exemplo: Template "Modern Tech"**
```typescript
const MODERN_TECH_TEMPLATE: Template = {
  id: 'modern-tech',
  name: 'Modern Tech',
  category: 'tech',
  
  layout: {
    pageSize: 'A4',
    margins: { top: 20, right: 20, bottom: 20, left: 20 }
  },
  
  typography: {
    primary: { family: 'Inter', weights: [700, 800] },
    body: { family: 'Lato', weights: [400, 600] },
    monospace: { family: 'Fira Code', weights: [400] }
  },
  
  colors: {
    primary: '#667eea',
    secondary: '#764ba2',
    accent: '#f093fb',
    background: '#ffffff',
    codeBlock: '#1a1a2e'
  },
  
  cover: {
    background: 'linear-gradient(135deg, #667eea, #764ba2)',
    title: {
      size: 72,
      weight: 800,
      color: 'white',
      fontFamily: 'Inter'
    },
    decoration: 'circuit-pattern-overlay'
  },
  
  header: {
    enabled: true,
    left: '${chapterTitle}',
    right: '${pageNumber}',
    separator: 'line',
    color: '#667eea'
  }
}
```

### Sistema de PersonalizaÃ§Ã£o
```tsx
<div className="template-customizer">
  <h3>Personalizar Template</h3>
  
  {/* Base Template */}
  <div className="base-template">
    <img src={selectedTemplate.thumbnail} />
    <h4>{selectedTemplate.name}</h4>
  </div>
  
  {/* Customization Tabs */}
  <div className="tabs">
    <button>ğŸ¨ Cores</button>
    <button>ğŸ”¤ Fontes</button>
    <button>ğŸ“ Layout</button>
    <button>ğŸ–¼ï¸ Capa</button>
  </div>
  
  {/* Quick Tweaks */}
  <div className="quick-tweaks">
    <label>
      Esquema de cores:
      <select>
        <option>Original</option>
        <option>Azul Profissional</option>
        <option>Verde Natureza</option>
        <option>Roxo Criativo</option>
      </select>
    </label>
    
    <label>
      Tamanho da fonte:
      <input type="range" min="0.8" max="1.2" step="0.1" />
    </label>
    
    <label>
      <input type="checkbox" />
      Modo escuro
    </label>
  </div>
  
  {/* Preview Live */}
  <div className="live-preview">
    <iframe src={`/preview/${selectedTemplate.id}?custom=${customizations}`} />
  </div>
  
  <button className="btn-primary">Aplicar Template</button>
</div>
```

### Galeria de Templates
```tsx
<div className="template-gallery">
  <div className="filters">
    <button>Todos</button>
    <button>Tecnologia</button>
    <button>NegÃ³cios</button>
    <button>Criativo</button>
    <button>AcadÃªmico</button>
  </div>
  
  <div className="search">
    <input placeholder="Buscar templates..." />
  </div>
  
  <div className="grid">
    {templates.map(template => (
      <div className="template-card">
        <img src={template.thumbnail} />
        <h4>{template.name}</h4>
        <p>{template.description}</p>
        <div className="actions">
          <button>ğŸ‘ï¸ Preview</button>
          <button>âœ¨ Usar</button>
          <button>â­ Favoritar</button>
        </div>
      </div>
    ))}
  </div>
</div>
```

ğŸ”„ Fluxo de Trabalho
1. UsuÃ¡rio Escreve no Editor
Editor TipTap:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ # Design Thinking               â”‚
â”‚ ## Uma jornada pela inovaÃ§Ã£o    â”‚
â”‚                                 â”‚
â”‚ Fundamentos essenciais...       â”‚
â”‚ Casos prÃ¡ticos e exemplos...    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
2. Vai para Aba DESIGN
// User clicks "Design" tab
setActiveTab('design')
// Auto-fetch content from editor
const editorContent = editor.getHTML()
// Send to AI Designer
const analysis = await fetch('/api/design/analyze', {
  method: 'POST',
  body: JSON.stringify({ content: editorContent })
})
3. IA Designer Analisa
Backend:

@router.post("/design/analyze")
async def analyze_content(request: DesignAnalyzeRequest):
    # Extrair tema, tom, audiÃªncia
    analysis = await design_agent.analyze_content(request.content)
    
    return {
        "topic": "design thinking",
        "tone": "professional-creative",
        "audience": "designers, inovadores",
        "suggested_palette": [
            {"hex": "#667eea", "name": "Primary Purple"},
            {"hex": "#764ba2", "name": "Deep Purple"},
            {"hex": "#f093fb", "name": "Accent Pink"},
            {"hex": "#f5f7fa", "name": "Light Gray"},
            {"hex": "#2d3748", "name": "Dark Text"}
        ],
        "typography": {
            "heading": "Inter",
            "subheading": "Lato",
            "body": "Open Sans",
            "accent": "Playfair Display"
        },
        "style": "modern-gradient"
    }
4. Gera Design Visual
IA cria HTML/CSS:

<!-- Cover Design -->
<div class="elegant-cover" style="
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  height: 800px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 60px;
  position: relative;
  overflow: hidden;
">
  <!-- Background pattern -->
  <svg class="bg-pattern" style="
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0.1;
  ">
    <!-- Geometric pattern -->
  </svg>
  
  <!-- Title -->
  <h1 style="
    font-family: 'Inter', sans-serif;
    font-size: 72px;
    font-weight: 800;
    color: white;
    text-align: center;
    margin: 0;
    letter-spacing: -2px;
    text-shadow: 0 4px 20px rgba(0,0,0,0.3);
  ">
    Design Thinking
  </h1>
  
  <!-- Subtitle -->
  <h2 style="
    font-family: 'Lato', sans-serif;
    font-size: 32px;
    font-weight: 300;
    color: rgba(255,255,255,0.9);
    margin-top: 20px;
    text-align: center;
  ">
    O Guia Definitivo
  </h2>
  
  <!-- Decorative element -->
  <div style="
    width: 100px;
    height: 4px;
    background: white;
    margin-top: 40px;
    border-radius: 2px;
  "></div>
</div>
5. Fabric.js para EdiÃ§Ã£o Visual
Frontend renderiza no canvas:

// DesignCanvas.tsx
import { fabric } from 'fabric'
const applyDesignToCanvas = (designData: DesignResponse) => {
  const canvas = new fabric.Canvas('design-canvas')
  
  // Add background gradient
  const gradient = new fabric.Gradient({
    type: 'linear',
    coords: { x1: 0, y1: 0, x2: canvas.width, y2: canvas.height },
    colorStops: [
      { offset: 0, color: '#667eea' },
      { offset: 1, color: '#764ba2' }
    ]
  })
  
  canvas.setBackgroundColor(gradient, canvas.renderAll.bind(canvas))
  
  // Add text elements
  const title = new fabric.Text('Design Thinking', {
    left: canvas.width / 2,
    top: 300,
    fontSize: 72,
    fontFamily: 'Inter',
    fontWeight: '800',
    fill: 'white',
    textAlign: 'center',
    shadow: new fabric.Shadow({
      color: 'rgba(0,0,0,0.3)',
      blur: 20
    })
  })
  
  canvas.add(title)
  canvas.centerObject(title)
  
  // Add subtitle, decorations, etc.
  // ...
}
6. UsuÃ¡rio Edita Visualmente
Arrasta elementos
Muda cores
Ajusta tipografia
Adiciona imagens
Ajusta layout
7. Aplica ao Editor
const handleApplyToEditor = () => {
  // 1. Export canvas to HTML/CSS
  const html = convertFabricToHTML(canvas)
  const css = extractCSS(canvas)
  
  // 2. Send to editor
  editor.commands.setContent(html)
  
  // 3. Switch to editor tab
  setActiveTab('editor')
  
  toast.success('Design aplicado com sucesso!')
}
ğŸ¨ Exemplos de Templates Gerados pela IA
Template 1: Tech/Futurista
AnÃ¡lise IA:

{
  "topic": "inteligÃªncia artificial",
  "palette": ["#00d4ff", "#0099ff", "#1a1a2e", "#16213e", "#e94560"],
  "typography": {
    "heading": "Orbitron",
    "body": "Roboto"
  },
  "style": "futuristic-tech",
  "elements": ["circuit patterns", "glowing effects", "sharp angles"]
}
CSS Gerado:

.tech-cover {
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  font-family: 'Orbitron', sans-serif;
  color: #00d4ff;
  position: relative;
}
.tech-cover::before {
  content: '';
  position: absolute;
  width: 100%;
  height: 100%;
  background-image: url('data:image/svg+xml,...'); /* Circuit pattern */
  opacity: 0.1;
}
.tech-title {
  font-size: 64px;
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 4px;
  text-shadow: 0 0 20px #00d4ff;
}
Template 2: Editorial ClÃ¡ssico
AnÃ¡lise IA:

{
  "topic": "literatura clÃ¡ssica",
  "palette": ["#2c2416", "#8b7355", "#f4e8c1", "#c19a6b", "#ffffff"],
  "typography": {
    "heading": "Playfair Display",
    "body": "Lora"
  },
  "style": "classic-editorial",
  "elements": ["ornaments", "serif fonts", "wide margins"]
}
Template 3: Minimalista Escandinavo
AnÃ¡lise IA:

{
  "topic": "design de interiores",
  "palette": ["#ffffff", "#f7f7f7", "#333333", "#e0e0e0", "#4a90e2"],
  "typography": {
    "heading": "Helvetica Neue",
    "body": "Arial"
  },
  "style": "minimalist-scandinavian",
  "elements": ["whitespace", "clean lines", "subtle accents"]
}
ğŸ“Š ComparaÃ§Ã£o: React Flow vs Fabric.js
Aspecto	React Flow (Anterior âŒ)	Fabric.js (Novo âœ…)
PropÃ³sito	Diagramas, fluxogramas	Design visual canvas
Output	JSON nodes/edges	HTML/CSS/Imagens
InteraÃ§Ã£o	Conectar nodes	Drag, resize, rotate
Tipografia	Limitada	Completa (Google Fonts)
Cores	BÃ¡sicas	Gradientes, paletas
Imagens	Ãcones simples	Full images, filters
Export	JSON	HTML, PNG, PDF
EdiÃ§Ã£o	Estrutural	Visual WYSIWYG
ğŸš€ Roadmap de ImplementaÃ§Ã£o
Fase 1: Setup Fabric.js (2-3 dias)
 Instalar fabric e @types/fabric
 Criar componente DesignCanvas.tsx
 Setup bÃ¡sico do canvas
 Toolbar com ferramentas bÃ¡sicas
 Sidebar com paletas de cores
Fase 2: Design Agent Backend (3-4 dias)
 Criar agents/design_agent.py
 Implementar anÃ¡lise de conteÃºdo
 Gerar paletas de cores
 Sugerir tipografia
 Criar templates HTML/CSS
Fase 3: IntegraÃ§Ã£o IA â†” Fabric.js (3-4 dias)
 Endpoint /api/design/analyze
 Endpoint /api/design/generate-cover
 Endpoint /api/design/generate-page
 Converter HTML da IA â†’ Fabric objects
 Preview em tempo real
Fase 4: Galeria de Templates (2-3 dias)
 Templates prÃ©-definidos (10+)
 Categorias (Tech, Business, Creative, etc.)
 Sistema de favoritos
 Preview thumbnails
Fase 5: Export & AplicaÃ§Ã£o (2 dias)
 Fabric â†’ HTML/CSS
 Embed images (base64)
 Aplicar ao TipTap Editor
 PDF export via @react-pdf/renderer
Fase 6: Polish & UX (2 dias)
 Undo/Redo
 Atalhos de teclado
 Zoom/Pan canvas
 Snap to grid
 Layers management
Total: ~15-20 dias

ğŸ“ DecisÃµes TÃ©cnicas
Fabric.js vs Konva.js
Escolha: Fabric.js âœ…

Motivo:

Mais maduro (10+ anos)
API mais intuitiva para canvas design
Melhor para editoraÃ§Ã£o (vs animaÃ§Ãµes)
Export SVG nativo
Comunidade maior
Google Fonts Integration
// Load fonts dynamically
const loadGoogleFont = (fontFamily: string) => {
  const link = document.createElement('link')
  link.href = `https://fonts.googleapis.com/css2?family=${fontFamily.replace(' ', '+')}:wght@300;400;600;800&display=swap`
  link.rel = 'stylesheet'
  document.head.appendChild(link)
}
// Usage
loadGoogleFont('Inter')
loadGoogleFont('Playfair Display')
Color Palette Generation
OpÃ§Ãµes:

IA gera cores baseado no tema
API Coolors.co (paletas prontas)
Algoritmo de harmonia de cores
Escolha: IA + validaÃ§Ã£o de contraste

âœ… PrÃ³ximos Passos Imediatos
Atualizar TEMPLATE_BOOKS.md com conceito correto
Criar aba Design no App.tsx
Instalar Fabric.js
Implementar Design Agent
Testar com conteÃºdo real do editor